{"version":3,"sources":["bulletGroup.js"],"names":["bPosition","cc","Class","name","properties","xAxis","default","tooltip","yAxis","bulletInfinite","freqTime","initPollCount","prefab","Prefab","position","type","bulletFiniteG","extends","finiteTime","orginName","Component","hero","Node","onLoad","eState","D","commonInfo","gameState","none","common","initObjPool","batchInitObjPool","startAction","start","getNewbullet","bICallback","bind","schedule","pauseAction","enabled","pause","resumeAction","changeBullet","ufoBulletName","unschedule","bFCallback","bi","length","e","delay","macro","REPEAT_FOREVER","bulletInfo","poolName","bc","newNode","genNewNode","node","newV2","getBulletPostion","setPosition","getComponent","bulletGroup","posInfo","hPos","getPosition","newV2_x","x","eval","newV2_y","y","p","bulletDied","nodeinfo","backObjPool"],"mappings":";;;;;;AAAA;AACA,IAAIA,YAAYC,GAAGC,KAAH,CAAS;AACrBC,UAAM,WADe;AAErBC,gBAAY;AACRC,eAAO;AACHC,qBAAQ,EADL;AAEHC,qBAAS;AAFN,SADC;AAKRC,eAAO;AACHF,qBAAQ,EADL;AAEHC,qBAAS;AAFN;AALC;AAFS,CAAT,CAAhB;;AAcA;AACA,IAAIE,iBAAiBR,GAAGC,KAAH,CAAS;AAC1BC,UAAK,gBADqB;AAE1BC,gBAAY;AACRD,cAAK,EADG;AAERO,kBAAS,CAFD;AAGRC,uBAAc,CAHN;AAIRC,gBAAOX,GAAGY,MAJF;AAKRC,kBAAU;AACNR,qBAAS,EADH;AAENS,kBAAMf,SAFA;AAGNO,qBAAS;AAHH;AALF;AAFc,CAAT,CAArB;;AAeA;AACA,IAAIS,gBAAgBf,GAAGC,KAAH,CAAS;AACzBC,UAAK,eADoB;AAEzBc,aAAQR,cAFiB;AAGzBL,gBAAY;AACRc,oBAAW,CADH;AAERC,mBAAU;AAFF;AAHa,CAAT,CAApB;;AASAlB,GAAGC,KAAH,CAAS;AACLe,aAAShB,GAAGmB,SADP;;AAGLhB,gBAAW;AAAA,eAAM;AACbK,4BAAgB;AACZH,yBAAQ,IADI;AAEZS,sBAAMN,cAFM;AAGZF,yBAAQ;AAHI,aADH;AAMbS,2BAAe;AACXV,yBAAQ,EADG;AAEXS,sBAAMC,aAFK;AAGXT,yBAAQ;AAHG,aANF;AAWbc,kBAAMpB,GAAGqB;AAXI,SAAN;AAAA,KAHN;;AAiBL;AACAC,YAAQ,kBAAY;AAChB,aAAKC,MAAL,GAAcC,EAAEC,UAAF,CAAaC,SAAb,CAAuBC,IAArC;AACA;AACAH,UAAEI,MAAF,CAASC,WAAT,CAAqB,IAArB,EAA2B,KAAKrB,cAAhC;AACA;AACAgB,UAAEI,MAAF,CAASE,gBAAT,CAA0B,IAA1B,EAAgC,KAAKf,aAArC;AACH,KAxBI;;AA0BLgB,iBAAa,uBAAU;AACnB,aAAKR,MAAL,GAAcC,EAAEC,UAAF,CAAaC,SAAb,CAAuBM,KAArC;AACA;AACA,aAAKC,YAAL,CAAkB,KAAKzB,cAAvB;AACA,aAAK0B,UAAL,GAAkB,YAAU;AAAC,iBAAKD,YAAL,CAAkB,KAAKzB,cAAvB;AAAwC,SAAnD,CAAoD2B,IAApD,CAAyD,IAAzD,CAAlB;AACA,aAAKC,QAAL,CAAc,KAAKF,UAAnB,EAA+B,KAAK1B,cAAL,CAAoBC,QAAnD;AAEH,KAjCI;AAkCL4B,iBAAa,uBAAU;AACnB,aAAKC,OAAL,GAAe,KAAf;AACA,aAAKf,MAAL,GAAcC,EAAEC,UAAF,CAAaC,SAAb,CAAuBa,KAArC;AACH,KArCI;AAsCLC,kBAAc,wBAAU;AACpB,aAAKF,OAAL,GAAe,IAAf;AACA,aAAKf,MAAL,GAAcC,EAAEC,UAAF,CAAaC,SAAb,CAAuBM,KAArC;AACH,KAzCI;AA0CL;AACAS,kBAAc,sBAASC,aAAT,EAAuB;AACjC,aAAKC,UAAL,CAAgB,KAAKT,UAArB;AACA,aAAKS,UAAL,CAAgB,KAAKC,UAArB;AACA,aAAK,IAAIC,KAAG,CAAZ,EAAeA,KAAG,KAAK9B,aAAL,CAAmB+B,MAArC,EAA6CD,IAA7C,EAAkD;;AAE9C,gBAAI,KAAK9B,aAAL,CAAmB8B,EAAnB,EAAuB3B,SAAvB,IAAoCwB,aAAxC,EAAsD;AAClD,qBAAKE,UAAL,GAAkB,UAASG,CAAT,EAAW;AAAC,yBAAKd,YAAL,CAAkB,KAAKlB,aAAL,CAAmBgC,CAAnB,CAAlB;AAA0C,iBAAtD,CAAuDZ,IAAvD,CAA4D,IAA5D,EAAiEU,EAAjE,CAAlB;AACA,qBAAKT,QAAL,CAAc,KAAKQ,UAAnB,EAA+B,KAAK7B,aAAL,CAAmB8B,EAAnB,EAAuBpC,QAAtD,EAA+D,KAAKM,aAAL,CAAmB8B,EAAnB,EAAuB5B,UAAtF;AACA,oBAAI+B,QAAQ,KAAKjC,aAAL,CAAmB8B,EAAnB,EAAuBpC,QAAvB,GAAkC,KAAKM,aAAL,CAAmB8B,EAAnB,EAAuB5B,UAArE;AACA,qBAAKmB,QAAL,CAAc,KAAKF,UAAnB,EAA8B,KAAK1B,cAAL,CAAoBC,QAAlD,EAA2DT,GAAGiD,KAAH,CAASC,cAApE,EAAmFF,KAAnF;AACH;AACJ;AACJ,KAvDI;AAwDL;AACAf,kBAAc,sBAAUkB,UAAV,EAAsB;AAChC,YAAIC,WAAWD,WAAWjD,IAAX,GAAkB,MAAjC;AACA,aAAK,IAAImD,KAAG,CAAZ,EAAeA,KAAGF,WAAWtC,QAAX,CAAoBiC,MAAtC,EAA8CO,IAA9C,EAAmD;AAC/C,gBAAIC,UAAU9B,EAAEI,MAAF,CAAS2B,UAAT,CAAoB,KAAKH,QAAL,CAApB,EAAmCD,WAAWxC,MAA9C,EAAqD,KAAK6C,IAA1D,CAAd;AACA,gBAAIC,QAAQ,KAAKC,gBAAL,CAAsBP,WAAWtC,QAAX,CAAoBwC,EAApB,CAAtB,CAAZ;AACAC,oBAAQK,WAAR,CAAoBF,KAApB;AACAH,oBAAQM,YAAR,CAAqB,QAArB,EAA+BC,WAA/B,GAA6C,IAA7C;AACH;AACJ,KAjEI;AAkEL;AACAH,sBAAkB,0BAASI,OAAT,EAAiB;AAC/B,YAAIC,OAAO,KAAK3C,IAAL,CAAU4C,WAAV,EAAX;AACA,YAAIC,UAAUF,KAAKG,CAAL,GAASC,KAAKL,QAAQ1D,KAAb,CAAvB;AACA,YAAIgE,UAAUL,KAAKM,CAAL,GAASF,KAAKL,QAAQvD,KAAb,CAAvB;AACA,eAAOP,GAAGsE,CAAH,CAAKL,OAAL,EAAcG,OAAd,CAAP;AACH,KAxEI;;AA0EL;AACAG,gBAAY,oBAASC,QAAT,EAAkB;AAC1B;AACAhD,UAAEI,MAAF,CAAS6C,WAAT,CAAqB,IAArB,EAA0BD,QAA1B;AACH;AACD;AACA;;AAEA;AAlFK,CAAT","file":"bulletGroup.js","sourceRoot":"../../../../assets/Script","sourcesContent":["//子弹生成位置\nvar bPosition = cc.Class({\n    name: 'bPosition',\n    properties: {\n        xAxis: {\n            default:'',\n            tooltip: '初始x轴，相对hero',\n        },\n        yAxis: {\n            default:'',\n            tooltip: '初始y轴，相对hero'\n        },\n    },\n});\n\n//不限时长子弹\nvar bulletInfinite = cc.Class({\n    name:'bulletInfinite',\n    properties: {\n        name:'',\n        freqTime:0,\n        initPollCount:0,\n        prefab:cc.Prefab,\n        position: {\n            default: [],\n            type: bPosition,\n            tooltip: '每次多少排子弹',\n        }\n    }\n});\n\n//有限时长子弹组\nvar bulletFiniteG = cc.Class({\n    name:'bulletFiniteG',\n    extends:bulletInfinite,\n    properties: {\n        finiteTime:0,\n        orginName:'',\n    }\n}); \n\ncc.Class({\n    extends: cc.Component,\n\n    properties:()=> ({\n        bulletInfinite: {\n            default:null,\n            type: bulletInfinite,\n            tooltip:'无限时长子弹组'\n        },\n        bulletFiniteG: {\n            default:[],\n            type: bulletFiniteG,\n            tooltip:'有限时长子弹组'\n        },\n        hero: cc.Node,\n    }),\n    \n    // use this for initialization\n    onLoad: function () {\n        this.eState = D.commonInfo.gameState.none;\n        //初始化无限子弹组\n        D.common.initObjPool(this, this.bulletInfinite);\n        //初始化有限子弹组\n        D.common.batchInitObjPool(this, this.bulletFiniteG);\n    },\n    \n    startAction: function(){\n        this.eState = D.commonInfo.gameState.start;\n        //生成子弹\n        this.getNewbullet(this.bulletInfinite);\n        this.bICallback = function(){this.getNewbullet(this.bulletInfinite);}.bind(this);\n        this.schedule(this.bICallback, this.bulletInfinite.freqTime);\n        \n    },\n    pauseAction: function(){\n        this.enabled = false;\n        this.eState = D.commonInfo.gameState.pause;\n    },\n    resumeAction: function(){\n        this.enabled = true;\n        this.eState = D.commonInfo.gameState.start;\n    },\n    //换子弹\n    changeBullet: function(ufoBulletName){\n        this.unschedule(this.bICallback);\n        this.unschedule(this.bFCallback);\n        for (var bi=0; bi<this.bulletFiniteG.length; bi++){\n            \n            if (this.bulletFiniteG[bi].orginName == ufoBulletName){\n                this.bFCallback = function(e){this.getNewbullet(this.bulletFiniteG[e]);}.bind(this,bi);\n                this.schedule(this.bFCallback, this.bulletFiniteG[bi].freqTime,this.bulletFiniteG[bi].finiteTime);\n                var delay = this.bulletFiniteG[bi].freqTime * this.bulletFiniteG[bi].finiteTime;\n                this.schedule(this.bICallback,this.bulletInfinite.freqTime,cc.macro.REPEAT_FOREVER,delay);\n            }\n        }\n    },\n    //生成子弹\n    getNewbullet: function (bulletInfo) {\n        var poolName = bulletInfo.name + 'Pool';\n        for (var bc=0; bc<bulletInfo.position.length; bc++){\n            var newNode = D.common.genNewNode(this[poolName],bulletInfo.prefab,this.node);\n            var newV2 = this.getBulletPostion(bulletInfo.position[bc]);\n            newNode.setPosition(newV2);\n            newNode.getComponent('bullet').bulletGroup = this;\n        }\n    },\n    //获取子弹位置\n    getBulletPostion: function(posInfo){\n        var hPos = this.hero.getPosition();\n        var newV2_x = hPos.x + eval(posInfo.xAxis);\n        var newV2_y = hPos.y + eval(posInfo.yAxis);\n        return cc.p(newV2_x, newV2_y); \n    },\n\n    //子弹灭亡\n    bulletDied: function(nodeinfo){\n        //回收节点\n        D.common.backObjPool(this,nodeinfo);\n    },\n    // called every frame, uncomment this function to activate update callback\n    // update: function (dt) {\n\n    // },\n});\n"]}